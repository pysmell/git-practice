私有协议栈开发
1、私有协议介绍
   （1）通过RMI进行远程服务调用
   （2）通过java的Socket+java序列化的方式进行跨节点调用
   （3）利用一些开源的RPC框架进行远程服务调用，Facebook的Thrift、Apache的Avro等
   （4）利用标准的公有协议进行跨节点服务调用，例如HTTP+XML、RESTFUL+JSON或者WebService
    跨节点的远程服务调用，除了链路层的物理连接外，还需要对请求和响应消息进行编解码。
    在请求和应答消息本身之外，也需要携带一些其他控制和管理类指令，例如链路建立的握手请求和
    响应消息、链路检测的心跳消息。
    私有协议并没有标准的定义，只要能够用于跨进程、跨主机数据交换的非标准协议，都可以称为私有协议
2、功能设计
   1、主要功能如下：
  （1）基于Netty的NIO通信框架，提供高性能的异步通信能力
  （2）提供消息的编解码框架，可以实现POJO的序列化和反序列化
  （3）提供基于IP地址的白名单接入认证机制
  （4）链路的有效性校验机制
  （5）链路的断连重连机制
   2、具体步骤
   （1）Netty协议栈客户端发送握手请求消息，携带节点ID等有效身份认证信息
   （2）Netty协议服务端对握手请求消息进行合法性校验，包括节点ID有效性校验、节点重复登录校验和IP
   地址合法性校验，校验通过后，返回登录成功的握手应答消息
   （3）链路建立成功之后，客户端发送业务消息
   （4）链路成功之后，服务端发送心跳消息
   （5）链路建立成功之后，客户端发送心跳消息
   （6）链路建立成功之后，服务器发送业务消息
   （7）服务端退出时，服务端关闭连接，客户端感知对方关闭连接后，被动关闭客户端连接
3、消息定义
    Netty协议消息定义包含两部分
    1、消息头
    2、消息体
    netty消息定义表（NettyMessage）
    名称   类型    长度    描述
    header Header  变长    消息头定义
    body   Object  变长    对于请求消息，它是方法的参数（只携带一个参数）；对于响应消息，它是返回值
    netty协议消息头定义
    crcCode 整型int  32     Netty消息的校验码，由三部分组成：1）0xABEF:固定值，表明该消息是Netty协议消息，2个字节；2）主版本号：1~255,1个字节；3）次版本号:1~255,1个字节。crcCode=0xABEF+主版本号+次版本号
    length  整型int  32     消息长度，整个消息，包括消息头和消息体
    sessionID 长整型long  64  集群节点内全局唯一，由会话ID生成器生成
    type     Byte    8        0：业务请求消息1：业务响应消息2：业务ONE WAY消息（既是请求又是响应消息）3：握手请求4、握手应答消息5、心跳请求消息6、心跳响应消息
    priority Byte    8       消息优先级：0~255
    attachment Map<String, Object> 变长   可选字段，用于扩展消息头
    Netty协议支持的数据类型




































